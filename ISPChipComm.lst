   1               		.file	"ISPChipComm.c"
   2               		.arch atmega169
   3               	__SREG__ = 0x3f
   4               	__SP_H__ = 0x3e
   5               	__SP_L__ = 0x3d
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
   8               		.global __do_copy_data
   9               		.global __do_clear_bss
  17               	.Ltext0:
  18               	.global	SyncErrorMessage
  19               		.section	.progmem.data,"a",@progbits
  22               	SyncErrorMessage:
  23 0000 5359 4E43 		.string	"SYNC ERROR"
  23      2045 5252 
  23      4F52 00
  24               		.text
  25               	.global	ISPCC_EnterChipProgrammingMode
  27               	ISPCC_EnterChipProgrammingMode:
  28               	.LFB8:
  29               	.LM1:
  30               	/* prologue: frame size=0 */
  31 0000 0F93      		push r16
  32 0002 1F93      		push r17
  33 0004 CF93      		push r28
  34               	/* prologue end (size=3) */
  35               	.LM2:
  36 0006 1091 0000 		lds r17,PacketBytes+5
  37               	.LM3:
  38 000a C091 0000 		lds r28,PacketBytes+4
  39               	.LM4:
  40 000e 8091 0000 		lds r24,PacketBytes+2
  41 0012 0E94 0000 		call MAIN_Delay1MS
  42               	.LM5:
  43 0016 8C2F      		mov r24,r28
  44 0018 8150      		subi r24,lo8(-(-1))
  45 001a 8436      		cpi r24,lo8(100)
  46 001c 08F0      		brlo .L2
  47               	.LM6:
  48 001e C8E1      		ldi r28,lo8(24)
  49               	.L2:
  50               	.LM7:
  51 0020 C150      		subi r28,lo8(-(-1))
  52 0022 CF3F      		cpi r28,lo8(-1)
  53 0024 09F4      		brne .+2
  54 0026 3FC0      		rjmp .L11
  55               	.LM8:
  56 0028 8091 0000 		lds r24,PacketBytes+8
  57 002c 0E94 0000 		call USI_SPITransmit
  58               	.LM9:
  59 0030 812F      		mov r24,r17
  60 0032 0E94 0000 		call MAIN_Delay1MS
  61               	.LM10:
  62 0036 8091 0000 		lds r24,PacketBytes+9
  63 003a 0E94 0000 		call USI_SPITransmit
  64               	.LM11:
  65 003e 812F      		mov r24,r17
  66 0040 0E94 0000 		call MAIN_Delay1MS
  67               	.LM12:
  68 0044 8091 0000 		lds r24,PacketBytes+10
  69 0048 0E94 0000 		call USI_SPITransmit
  70 004c 082F      		mov r16,r24
  71               	.LM13:
  72 004e 812F      		mov r24,r17
  73 0050 0E94 0000 		call MAIN_Delay1MS
  74               	.LM14:
  75 0054 8091 0000 		lds r24,PacketBytes+7
  76 0058 8330      		cpi r24,lo8(3)
  77 005a 29F4      		brne .L5
  78               	.LM15:
  79 005c 8091 0000 		lds r24,PacketBytes+11
  80 0060 0E94 0000 		call USI_SPITransmit
  81 0064 05C0      		rjmp .L6
  82               	.L5:
  83               	.LM16:
  84 0066 8091 0000 		lds r24,PacketBytes+11
  85 006a 0E94 0000 		call USI_SPITransmit
  86 006e 082F      		mov r16,r24
  87               	.L6:
  88               	.LM17:
  89 0070 8091 0000 		lds r24,PacketBytes+7
  90 0074 8823      		tst r24
  91 0076 21F0      		breq .L8
  92 0078 8091 0000 		lds r24,PacketBytes+6
  93 007c 0817      		cp r16,r24
  94 007e 69F4      		brne .L7
  95               	.L8:
  96               	.LM18:
  97 0080 812F      		mov r24,r17
  98 0082 0E94 0000 		call MAIN_Delay1MS
  99               	.LM19:
 100 0086 81E0      		ldi r24,lo8(1)
 101 0088 8093 0000 		sts InProgrammingMode,r24
 102               	.LM20:
 103 008c 81B3      		in r24,49-0x20
 104 008e 8F7C      		andi r24,lo8(-49)
 105 0090 8062      		ori r24,lo8(32)
 106 0092 81BB      		out 49-0x20,r24
 107               	.LM21:
 108 0094 1092 0000 		sts PacketBytes+1,__zero_reg__
 109               	.LM22:
 110 0098 0DC0      		rjmp .L1
 111               	.L7:
 112               	.LM23:
 113 009a 812F      		mov r24,r17
 114 009c 0E94 0000 		call MAIN_Delay1MS
 115               	.LM24:
 116 00a0 0E94 0000 		call USI_SPIToggleClock
 117 00a4 BDCF      		rjmp .L2
 118               	.L11:
 119               	.LM25:
 120 00a6 81B3      		in r24,49-0x20
 121 00a8 8F7C      		andi r24,lo8(-49)
 122 00aa 8061      		ori r24,lo8(16)
 123 00ac 81BB      		out 49-0x20,r24
 124               	.LM26:
 125 00ae 80EC      		ldi r24,lo8(-64)
 126 00b0 8093 0000 		sts PacketBytes+1,r24
 127               	.L1:
 128               	/* epilogue: frame size=0 */
 129 00b4 CF91      		pop r28
 130 00b6 1F91      		pop r17
 131 00b8 0F91      		pop r16
 132 00ba 0895      		ret
 133               	/* epilogue end (size=4) */
 134               	/* function ISPCC_EnterChipProgrammingMode size 93 (86) */
 135               	.LFE8:
 137               	.global	ISPCC_PollForProgComplete
 139               	ISPCC_PollForProgComplete:
 140               	.LFB10:
 141               	.LM27:
 142               	/* prologue: frame size=0 */
 143 00bc 1F93      		push r17
 144 00be CF93      		push r28
 145 00c0 DF93      		push r29
 146               	/* prologue end (size=3) */
 147 00c2 EB01      		movw r28,r22
 148               	.LM28:
 149 00c4 9927      		clr r25
 150 00c6 80FF      		sbrs r24,0
 151 00c8 08C0      		rjmp .L13
 152               	.LM29:
 153 00ca 8077      		andi r24,lo8(112)
 154 00cc 9070      		andi r25,hi8(112)
 155 00ce 34E0      		ldi r19,4
 156 00d0 9595      	1:	asr r25
 157 00d2 8795      		ror r24
 158 00d4 3A95      		dec r19
 159 00d6 E1F7      		brne 1b
 160 00d8 04C0      		rjmp .L14
 161               	.L13:
 162               	.LM30:
 163 00da 8E70      		andi r24,lo8(14)
 164 00dc 9070      		andi r25,hi8(14)
 165 00de 9595      		asr r25
 166 00e0 8795      		ror r24
 167               	.L14:
 168               	.LM31:
 169 00e2 9927      		clr r25
 170 00e4 8770      		andi r24,lo8(7)
 171 00e6 9070      		andi r25,hi8(7)
 172 00e8 8230      		cpi r24,2
 173 00ea 9105      		cpc r25,__zero_reg__
 174 00ec 19F0      		breq .L16
 175 00ee 0497      		sbiw r24,4
 176 00f0 E1F0      		breq .L23
 177 00f2 26C0      		rjmp .L26
 178               	.L16:
 179               	.LM32:
 180 00f4 1091 0000 		lds r17,PacketBytes+7
 181               	.LM33:
 182 00f8 8091 0000 		lds r24,PacketBytes
 183 00fc 8331      		cpi r24,lo8(19)
 184 00fe 39F4      		brne .L19
 185               	.LM34:
 186 0100 812F      		mov r24,r17
 187 0102 9927      		clr r25
 188 0104 C0FD      		sbrc r28,0
 189 0106 8860      		ori r24,lo8(8)
 190               	.L18:
 191 0108 182F      		mov r17,r24
 192               	.LM35:
 193 010a D695      		lsr r29
 194 010c C795      		ror r28
 195               	.L19:
 196               	.LM36:
 197 010e 812F      		mov r24,r17
 198 0110 0E94 0000 		call USI_SPITransmit
 199               	.LM37:
 200 0114 CE01      		movw r24,r28
 201 0116 0E94 0000 		call USI_SPITransmitWord
 202               	.LM38:
 203 011a 80E0      		ldi r24,lo8(0)
 204 011c 0E94 0000 		call USI_SPITransmit
 205 0120 9091 0000 		lds r25,PacketBytes+8
 206 0124 8917      		cp r24,r25
 207 0126 99F3      		breq .L19
 208               	.LM39:
 209 0128 0FC0      		rjmp .L12
 210               	.L23:
 211               	.LM40:
 212 012a 80E0      		ldi r24,lo8(-4096)
 213 012c 90EF      		ldi r25,hi8(-4096)
 214 012e 0E94 0000 		call USI_SPITransmitWord
 215 0132 80E0      		ldi r24,lo8(0)
 216 0134 90E0      		ldi r25,hi8(0)
 217 0136 0E94 0000 		call USI_SPITransmitWord
 218 013a 80FD      		sbrc r24,0
 219 013c F6CF      		rjmp .L23
 220               	.LM41:
 221 013e 04C0      		rjmp .L12
 222               	.L26:
 223               	.LM42:
 224 0140 8091 0000 		lds r24,PacketBytes+4
 225 0144 0E94 0000 		call MAIN_Delay1MS
 226               	.L12:
 227               	/* epilogue: frame size=0 */
 228 0148 DF91      		pop r29
 229 014a CF91      		pop r28
 230 014c 1F91      		pop r17
 231 014e 0895      		ret
 232               	/* epilogue end (size=4) */
 233               	/* function ISPCC_PollForProgComplete size 76 (69) */
 234               	.LFE10:
 236               	.global	ISPCC_ProgramChip
 238               	ISPCC_ProgramChip:
 239               	.LFB9:
 240               	.LM43:
 241               	/* prologue: frame size=0 */
 242 0150 6F92      		push r6
 243 0152 7F92      		push r7
 244 0154 9F92      		push r9
 245 0156 AF92      		push r10
 246 0158 BF92      		push r11
 247 015a CF92      		push r12
 248 015c DF92      		push r13
 249 015e EF92      		push r14
 250 0160 FF92      		push r15
 251 0162 0F93      		push r16
 252 0164 1F93      		push r17
 253 0166 CF93      		push r28
 254 0168 DF93      		push r29
 255               	/* prologue end (size=13) */
 256               	.LM44:
 257 016a 00E0      		ldi r16,lo8(0)
 258 016c 10E0      		ldi r17,hi8(0)
 259               	.LM45:
 260 016e 9090 0000 		lds r9,PacketBytes+3
 261               	.LM46:
 262 0172 C090 0000 		lds r12,PacketBytes+5
 263               	.LM47:
 264 0176 6090 0000 		lds r6,CurrAddress
 265 017a 7090 0000 		lds r7,(CurrAddress)+1
 266               	.LM48:
 267 017e 8091 0000 		lds r24,PacketBytes+1
 268 0182 9927      		clr r25
 269 0184 B82E      		mov r11,r24
 270 0186 AA24      		clr r10
 271 0188 8091 0000 		lds r24,PacketBytes+2
 272 018c 9927      		clr r25
 273 018e A82A      		or r10,r24
 274 0190 B92A      		or r11,r25
 275               	.LM49:
 276 0192 90FE      		sbrs r9,0
 277 0194 62C0      		rjmp .L28
 278               	.LBB2:
 279               	.LM50:
 280 0196 7801      		movw r14,r16
 281 0198 0A15      		cp r16,r10
 282 019a 1B05      		cpc r17,r11
 283 019c 08F0      		brlo .+2
 284 019e 46C0      		rjmp .L59
 285 01a0 C0E0      		ldi r28,lo8(PacketBytes+10)
 286 01a2 D0E0      		ldi r29,hi8(PacketBytes+10)
 287               	.L41:
 288               	.LM51:
 289 01a4 D990      		ld r13,Y+
 290               	.LM52:
 291 01a6 8091 0000 		lds r24,PacketBytes
 292 01aa 8331      		cpi r24,lo8(19)
 293 01ac 31F4      		brne .L32
 294               	.LM53:
 295 01ae 8C2D      		mov r24,r12
 296 01b0 9927      		clr r25
 297 01b2 E0FE      		sbrs r14,0
 298 01b4 03C0      		rjmp .L61
 299 01b6 8860      		ori r24,lo8(8)
 300 01b8 01C0      		rjmp .L61
 301               	.L32:
 302               	.LM54:
 303 01ba 8C2D      		mov r24,r12
 304               	.L61:
 305 01bc 0E94 0000 		call USI_SPITransmit
 306               	.LM55:
 307 01c0 8091 0000 		lds r24,CurrAddress
 308 01c4 9091 0000 		lds r25,(CurrAddress)+1
 309 01c8 0E94 0000 		call USI_SPITransmitWord
 310               	.LM56:
 311 01cc 8D2D      		mov r24,r13
 312 01ce 0E94 0000 		call USI_SPITransmit
 313               	.LM57:
 314 01d2 0115      		cp r16,__zero_reg__
 315 01d4 1105      		cpc r17,__zero_reg__
 316 01d6 D9F4      		brne .L35
 317               	.LM58:
 318 01d8 8091 0000 		lds r24,PacketBytes+8
 319 01dc 8D15      		cp r24,r13
 320 01de B9F0      		breq .L35
 321 01e0 9091 0000 		lds r25,PacketBytes
 322 01e4 9331      		cpi r25,lo8(19)
 323 01e6 31F0      		breq .L37
 324 01e8 9531      		cpi r25,lo8(21)
 325 01ea 89F4      		brne .L35
 326 01ec 8091 0000 		lds r24,PacketBytes+9
 327 01f0 8D15      		cp r24,r13
 328 01f2 69F0      		breq .L35
 329               	.L37:
 330               	.LM59:
 331 01f4 0091 0000 		lds r16,CurrAddress
 332 01f8 1091 0000 		lds r17,(CurrAddress)+1
 333               	.LM60:
 334 01fc 9331      		cpi r25,lo8(19)
 335 01fe 39F4      		brne .L35
 336               	.LM61:
 337 0200 000F      		lsl r16
 338 0202 111F      		rol r17
 339 0204 C701      		movw r24,r14
 340 0206 8170      		andi r24,lo8(1)
 341 0208 9070      		andi r25,hi8(1)
 342 020a 080F      		add r16,r24
 343 020c 191F      		adc r17,r25
 344               	.L35:
 345               	.LM62:
 346 020e E0FC      		sbrc r14,0
 347 0210 04C0      		rjmp .L40
 348 0212 8091 0000 		lds r24,PacketBytes
 349 0216 8531      		cpi r24,lo8(21)
 350 0218 11F4      		brne .L31
 351               	.L40:
 352               	.LM63:
 353 021a 0E94 0000 		call V2P_IncrementCurrAddress
 354               	.L31:
 355               	.LM64:
 356 021e 0894      		sec
 357 0220 E11C      		adc r14,__zero_reg__
 358 0222 F11C      		adc r15,__zero_reg__
 359 0224 EA14      		cp r14,r10
 360 0226 FB04      		cpc r15,r11
 361 0228 08F4      		brsh .+2
 362 022a BCCF      		rjmp .L41
 363               	.L59:
 364               	.LBE2:
 365               	.LM65:
 366 022c C92D      		mov r28,r9
 367               	.LM66:
 368 022e 97FE      		sbrs r9,7
 369 0230 69C0      		rjmp .L27
 370               	.LM67:
 371 0232 8091 0000 		lds r24,PacketBytes+6
 372 0236 0E94 0000 		call USI_SPITransmit
 373               	.LM68:
 374 023a C301      		movw r24,r6
 375 023c 0E94 0000 		call USI_SPITransmitWord
 376               	.LM69:
 377 0240 80E0      		ldi r24,lo8(0)
 378 0242 0E94 0000 		call USI_SPITransmit
 379               	.LM70:
 380 0246 0115      		cp r16,__zero_reg__
 381 0248 1105      		cpc r17,__zero_reg__
 382 024a 11F4      		brne .L43
 383               	.LM71:
 384 024c CF78      		andi r28,lo8(-113)
 385 024e C061      		ori r28,lo8(16)
 386               	.L43:
 387               	.LM72:
 388 0250 B801      		movw r22,r16
 389 0252 8C2F      		mov r24,r28
 390 0254 0E94 0000 		call ISPCC_PollForProgComplete
 391 0258 55C0      		rjmp .L27
 392               	.L28:
 393               	.LBB3:
 394               	.LM73:
 395 025a 7801      		movw r14,r16
 396 025c 0A15      		cp r16,r10
 397 025e 1B05      		cpc r17,r11
 398 0260 08F0      		brlo .+2
 399 0262 50C0      		rjmp .L27
 400 0264 50E0      		ldi r21,lo8(PacketBytes+10)
 401 0266 652E      		mov r6,r21
 402 0268 50E0      		ldi r21,hi8(PacketBytes+10)
 403 026a 752E      		mov r7,r21
 404               	.L57:
 405               	.LM74:
 406 026c F301      		movw r30,r6
 407 026e D190      		ld r13,Z+
 408 0270 3F01      		movw r6,r30
 409               	.LM75:
 410 0272 8091 0000 		lds r24,PacketBytes
 411 0276 8331      		cpi r24,lo8(19)
 412 0278 31F4      		brne .L48
 413               	.LM76:
 414 027a 8C2D      		mov r24,r12
 415 027c 9927      		clr r25
 416 027e E0FE      		sbrs r14,0
 417 0280 03C0      		rjmp .L62
 418 0282 8860      		ori r24,lo8(8)
 419 0284 01C0      		rjmp .L62
 420               	.L48:
 421               	.LM77:
 422 0286 8C2D      		mov r24,r12
 423               	.L62:
 424 0288 0E94 0000 		call USI_SPITransmit
 425               	.LM78:
 426 028c 8091 0000 		lds r24,CurrAddress
 427 0290 9091 0000 		lds r25,(CurrAddress)+1
 428 0294 0E94 0000 		call USI_SPITransmitWord
 429               	.LM79:
 430 0298 8D2D      		mov r24,r13
 431 029a 0E94 0000 		call USI_SPITransmit
 432               	.LM80:
 433 029e C92D      		mov r28,r9
 434               	.LM81:
 435 02a0 8091 0000 		lds r24,PacketBytes+8
 436 02a4 8D15      		cp r24,r13
 437 02a6 C1F0      		breq .L51
 438 02a8 9091 0000 		lds r25,PacketBytes
 439 02ac 9331      		cpi r25,lo8(19)
 440 02ae 31F0      		breq .L52
 441 02b0 9531      		cpi r25,lo8(21)
 442 02b2 91F4      		brne .L51
 443 02b4 8091 0000 		lds r24,PacketBytes+9
 444 02b8 8D15      		cp r24,r13
 445 02ba 71F0      		breq .L51
 446               	.L52:
 447               	.LM82:
 448 02bc 0091 0000 		lds r16,CurrAddress
 449 02c0 1091 0000 		lds r17,(CurrAddress)+1
 450               	.LM83:
 451 02c4 9331      		cpi r25,lo8(19)
 452 02c6 59F4      		brne .L54
 453               	.LM84:
 454 02c8 000F      		lsl r16
 455 02ca 111F      		rol r17
 456 02cc C701      		movw r24,r14
 457 02ce 8170      		andi r24,lo8(1)
 458 02d0 9070      		andi r25,hi8(1)
 459 02d2 080F      		add r16,r24
 460 02d4 191F      		adc r17,r25
 461 02d6 03C0      		rjmp .L54
 462               	.L51:
 463               	.LM85:
 464 02d8 C92D      		mov r28,r9
 465 02da C17F      		andi r28,lo8(-15)
 466 02dc C260      		ori r28,lo8(2)
 467               	.L54:
 468               	.LM86:
 469 02de E0FC      		sbrc r14,0
 470 02e0 04C0      		rjmp .L56
 471 02e2 8091 0000 		lds r24,PacketBytes
 472 02e6 8531      		cpi r24,lo8(21)
 473 02e8 11F4      		brne .L55
 474               	.L56:
 475               	.LM87:
 476 02ea 0E94 0000 		call V2P_IncrementCurrAddress
 477               	.L55:
 478               	.LM88:
 479 02ee B801      		movw r22,r16
 480 02f0 8C2F      		mov r24,r28
 481 02f2 0E94 0000 		call ISPCC_PollForProgComplete
 482               	.LM89:
 483 02f6 0894      		sec
 484 02f8 E11C      		adc r14,__zero_reg__
 485 02fa F11C      		adc r15,__zero_reg__
 486 02fc EA14      		cp r14,r10
 487 02fe FB04      		cpc r15,r11
 488 0300 08F4      		brsh .+2
 489 0302 B4CF      		rjmp .L57
 490               	.L27:
 491               	.LBE3:
 492               	/* epilogue: frame size=0 */
 493 0304 DF91      		pop r29
 494 0306 CF91      		pop r28
 495 0308 1F91      		pop r17
 496 030a 0F91      		pop r16
 497 030c FF90      		pop r15
 498 030e EF90      		pop r14
 499 0310 DF90      		pop r13
 500 0312 CF90      		pop r12
 501 0314 BF90      		pop r11
 502 0316 AF90      		pop r10
 503 0318 9F90      		pop r9
 504 031a 7F90      		pop r7
 505 031c 6F90      		pop r6
 506 031e 0895      		ret
 507               	/* epilogue end (size=14) */
 508               	/* function ISPCC_ProgramChip size 232 (205) */
 509               	.LFE9:
 511               	.Letext0:
DEFINED SYMBOLS
                            *ABS*:00000000 ISPChipComm.c
C:\DOCUME~1\Dean\LOCALS~1\Temp/ccE3aaaa.s:3      *ABS*:0000003f __SREG__
C:\DOCUME~1\Dean\LOCALS~1\Temp/ccE3aaaa.s:4      *ABS*:0000003e __SP_H__
C:\DOCUME~1\Dean\LOCALS~1\Temp/ccE3aaaa.s:5      *ABS*:0000003d __SP_L__
C:\DOCUME~1\Dean\LOCALS~1\Temp/ccE3aaaa.s:6      *ABS*:00000000 __tmp_reg__
C:\DOCUME~1\Dean\LOCALS~1\Temp/ccE3aaaa.s:7      *ABS*:00000001 __zero_reg__
C:\DOCUME~1\Dean\LOCALS~1\Temp/ccE3aaaa.s:22     .progmem.data:00000000 SyncErrorMessage
C:\DOCUME~1\Dean\LOCALS~1\Temp/ccE3aaaa.s:27     .text:00000000 ISPCC_EnterChipProgrammingMode
C:\DOCUME~1\Dean\LOCALS~1\Temp/ccE3aaaa.s:139    .text:000000bc ISPCC_PollForProgComplete
C:\DOCUME~1\Dean\LOCALS~1\Temp/ccE3aaaa.s:238    .text:00000150 ISPCC_ProgramChip

UNDEFINED SYMBOLS
__do_copy_data
__do_clear_bss
PacketBytes
MAIN_Delay1MS
USI_SPITransmit
InProgrammingMode
USI_SPIToggleClock
USI_SPITransmitWord
CurrAddress
V2P_IncrementCurrAddress
